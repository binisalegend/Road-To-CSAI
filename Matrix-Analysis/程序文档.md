# 题目A：基本矩阵分解算法实现
---
> [!NOTE] 任务要求
> 编写程序实现矩阵的 LU 分解、QR 分解（Gram-Schmidt）、正交约减(Householder reduction 和 Givens reduction)。要求编写一个综合程序，根据选择参数的不同，实现不同的矩阵分解，并附上具体实例。

## **原理阐述**

### LU分解
- 三角分解：设矩阵 $A \in M_{n}$，如果存在下三角矩阵 $L \in M_{n}$ 且上三角矩阵 $R \in M_{n}$，使得$$A = LR$$则称矩阵 $A$ 可以做三角分解。

- 可进行三角分解的矩阵 $A$ 可以表示为$$A = \left[\begin{array}{cccc}l_{11} & 0 & \cdots & 0 \\\vdots & \ddots & \ddots & \vdots \\l_{n1} & \cdots & l_{nn} & 0 \\\end{array}\right]\left[\begin{array}{ccc}r_{11} & \cdots & r_{1n} \\0 & \ddots & \vdots \\0 & \cdots & r_{nn} \\\end{array}\right]$$

- LU分解作为一种特殊的三角分解，其下三角矩阵$L$的对角元素均为1：$$A=LR=\begin{bmatrix}1&0&0\\\vdots&1&0\\l_{n1}&\cdots&1\end{bmatrix}\begin{bmatrix}r_{11}&\cdots&r_{1n}\\0&\ddots&\vdots\\0&0&r_{nn}\end{bmatrix}$$
### QR分解

> [!NOTE] 定义
> 给定矩阵$A\in M_{m\times n}$，如果能够将$A$分解为两个矩阵$Q\in M_{m\times n}$和$R\in M_{n}$的乘积，其中
> - $Q$具有标准正交列向量
> - $R$是具有非负主对角元素的上三角矩阵
> 
> 则称$A=QR$为矩阵$A$的QR分解(正三角分解)$$\left.A=QR=\left[\begin{matrix}\\q_1&\cdots&q_n\\\\&&\end{matrix}\right.\right]_{m\times n}\left[\begin{matrix}r_{11}&\cdots&r_{1n}\\0&\ddots&\vdots\\0&0&r_{nn}\end{matrix}\right]_{n\times n}$$

1. 若$rank(A)=n$，则$Q$和$R$均唯一确定，且$R$的主对角元素全为正数
2. 若$m=n$，则$Q$为酉矩阵
3. 存在一个酉矩阵$Q\in M_{m}$以及一个具有非负对角元素的上三角矩阵$R\in M_{m\times n}$，使得$A=QR$

#### 求矩阵QR分解的步骤
1. 进行施密特正交化$$\begin{aligned}
&\beta_{1}=\alpha_{1} \\
&\beta_{2}=\alpha_{2}-\frac{(\alpha_{2},\beta_{1})}{(\beta_{1},\beta_{1})}\beta_{1} \\
&\beta_{3}=\alpha_{3}-\frac{\left(\alpha_{3},\beta_{1}\right)}{\left(\beta_{1},\beta_{1}\right)}\beta_{1}-\frac{\left(\alpha_{3},\beta_{2}\right)}{\left(\beta_{2},\beta_{2}\right)}\beta_{2}\\ &\vdots\\
 &\beta_s=\alpha_s-\frac{(\alpha_s,\beta_1)}{(\beta_1,\beta_1)}\beta_1-\frac{(\alpha_s,\beta_2)}{(\beta_2,\beta_2)}\beta_2-\cdots-\frac{(\alpha_s,\beta_{s-1})}{(\beta_{s-1},\beta_{s-1})}\beta_{s-1}
\end{aligned}$$
2. 单位化(求$Q$矩阵)
3. 进行转换(求$R$矩阵)

### 正交约减

#### Householder Reduction
> [!NOTE] 定义
> 设$w$是一个单位向量，令$$H(w) = I-2ww^{T}$$则称$H$是一个Householder变换；其中，$$w=\frac{x-\lambda e_{1}}{||x-\lambda e_{1}||}$$

引用老师课件的图片：![](Pasted%20image%2020240306085344.png)
- 几何意义：采用Householder变换可以依次将列向量转换为指定上三角形式


#### Givens Reduction
> [!NOTE] 定义
> 设$c,s\in F$且满足$c^{2}+s^{2}=1$，则称方阵$G_{pq}$为$Givens$矩阵
> $$\boldsymbol{G}_{{\mathrm{pq}}}=\begin{bmatrix}1\\&\ddots\\&&1\\&&&\mathrm{c}&0&\cdots&0&\mathrm{s}\\&&&0&1&\cdots&0&0\\&&&\vdots&\vdots&&\vdots&\vdots\\&&&0&0&\cdots&1&0\\&&&&-\mathrm{s}&0&\cdots&0&\mathrm{c}\\&&&&&&&1\\&&&&&&&&\ddots\\&&&&&&&&&1\end{bmatrix}$$

- $Givens$矩阵是酉矩阵，且$det(G_{pq})=1$

> [!TIPS] 定理
> 设${x}=(x_1,...,x_n)^\mathrm{T}\in F^n$，则存在$Givens$矩阵$G_{12},G_{13},\cdots,G_{1n}$使得$$G_{1n}\cdots G_{13}G_{12}x=\left\|x\right\|_2e_1$$称为用$Givens$变换将向量$x$与$e_{1}$转换为同方向


# 任务B：利用SVD分解进行图片压缩去噪
---
> [!NOTE] 任务要求
> 数字图片在计算机中是以矩阵形式存储的，所以可以通过矩阵理论和矩阵算法对数字图像进行分析和处理。本任务要求编写程序实现矩阵的 SVD 分解，编写一个综合程序，实现基于 SVD 分解的图片压缩、降噪。并根据图像质量评价指标PSNR、SSIM 评估压缩、降噪结果。画出 PSNR、SSIM 随奇异值保留数量的变化关系曲线，以及其他结果展示。

## 原理阐述
> [!NOTE] 定义
> 假设存在$A\in M_{m\times n}$，则存在一个分解使得$$A=U\sum\limits V^{*}$$其中
> - $U$：$m\times m$阶酉矩阵；$U=\begin{bmatrix}u_1,u_2,...,u_m\end{bmatrix}$
> - $\sum\limits$：半正定$m\times n$阶对角矩阵；$\sum=\begin{bmatrix}\sigma_1&0&0&0\\0&\ddots&0&0\\0&0&\sigma_m&0\end{bmatrix}$
> - $V$：$n\times n$阶酉矩阵；$V=\begin{bmatrix}v_1,v_2,...,v_n\end{bmatrix}$
> 
> 这样的分解称为**奇异值分解(Singular value decomposition, SVD)**，对角线上的元素称为奇异值

### 什么是奇异值分解
奇异值分解是特征值及特征向量分解在任意矩阵的推广

$$A=U\sum V^{T}\rightarrow AV=U\sum\limits$$

- 若$A$是方阵且$m=n$，则$\sigma_1^2,\sigma_2^2,...,\sigma_m^2$是$AA^{T}$的特征值，$\begin{bmatrix}u_1,u_2,...,u_m\end{bmatrix}$是$AA^{T}$的特征向量


### 意义

- 几何意义：将正交的向量组变换到另外正交的向量组(尺度可伸缩)![](Pasted%20image%2020240410232341.png)

### 计算
> [!IMPORTANT] 计算矩阵$A_{m\times n}$的奇异值分解步骤：求$U,V,\sum\limits$
> 1. 计算$m\times m$的方阵$AA^{T}$
> 2. 计算$AA^{T}$的特征值与特征向量$\{\lambda_{i}\}$和$\{u_{i}\}$：$$(AA^{T})u_{i}=\lambda_{i}u_{i}$$
> 3. 获得左奇异向量组成的矩阵$U$：$$U=\begin{bmatrix}u_1,u_2,...,u_m\end{bmatrix}$$
> 4. 计算$A^{T}A$的特征值与特征向量$\{\lambda_{i}\}$和$\{v_{i}\}$：$$(A^{T}A)v_{i}=\lambda_{i}v_{i}$$
> 5. 获得右奇异向量组成的矩阵$V$：$$V=\begin{bmatrix}v_1,v_2,...,v_n\end{bmatrix}$$
> 6. 计算奇异值：$$\sigma_{i}=\sqrt{\lambda_{i}}$$
> 7. 依次排序奇异值，获得奇异值矩阵![](Pasted%20image%2020240411001615.png)


# 代码自述
